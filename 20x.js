const questions =
    [
        {
            "type": "closed",
            "question": "Jaka jest fundamentalna różnica w funkcji postaci Papkina w 'Zemście' i postaci Chilona Chilonidesa w 'Quo vadis'?",
            "answers": [
                { "text": "Obie postacie są tchórzliwe, ale Papkin jest Polakiem, a Chilon Grekiem.", "correct": false },
                { "text": "Papkin jest postacią głównie komiczną, której słabości służą rozrywce. Chilon, mimo początkowego cynizmu, przechodzi głęboką przemianę i staje się postacią tragiczną, symbolem odkupienia.", "correct": true },
                { "text": "Papkin służy Cześnikowi, a Chilon Neronowi.", "correct": false },
                { "text": "Papkin umiera ze strachu, a Chilon ginie śmiercią męczeńską.", "correct": false }
            ]
        },
        {
            "type": "open",
            "question": "W 'Małym Księciu', co symbolizuje fakt, że planeta Pijaka jest najmniejsza ze wszystkich, które odwiedził Mały Książę?",
            "answer": ["Symbolizuje to, że świat człowieka pogrążonego w nałogu i błędnym kole absurdu kurczy się do minimum. Nie ma w nim miejsca na nic innego – ani na relacje, ani na rozwój, ani na piękno. Jest to metafora egzystencjalnego zamknięcia i ciasnoty duchowej."]
        },
        {
            "type": "closed",
            "question": "Wskaż zdanie, w którym imiesłowowy równoważnik zdania jest użyty błędnie.",
            "answers": [
                { "text": "Biegnąc na autobus, zgubił portfel.", "correct": false },
                { "text": "Wyprowadziwszy psa, wrócił do domu.", "correct": false },
                { "text": "Jedząc zupę, widelec wypadł mu z ręki.", "correct": true },
                { "text": "Słuchając muzyki, czuł się zrelaksowany.", "correct": false }
            ]
        },
        {
            "type": "closed",
            "question": "Co łączy postawę moralną Aleksego Dawidowskiego ('Alek') z 'Kamieni na szaniec' z postawą Nemeczka z 'Chłopców z Placu Broni'?",
            "answers": [
                { "text": "Obaj są najmłodszymi członkami swoich grup.", "correct": false },
                { "text": "W obu przypadkach cechuje ich brawurowa odwaga i skłonność do podejmowania indywidualnego, często niebezpiecznego ryzyka w imię sprawy, którą uważają za słuszną.", "correct": true },
                { "text": "Obaj pełnią funkcje dowódcze i strategiczne.", "correct": false },
                { "text": "Obaj giną w wyniku zdrady swoich towarzyszy.", "correct": false }
            ]
        },
        {
            "type": "open",
            "question": "W 'Panu Tadeuszu' Zosia karmi ptactwo domowe. Jaka jest symboliczna funkcja tej sceny?",
            "answer": ["Scena ta charakteryzuje Zosię jako osobę dobrą, opiekuńczą i żyjącą w harmonii z naturą. Jest ona 'panią' swojego małego świata, w którym panuje porządek i ład. To symbol jej niewinności, prostoty i gospodarności, cech idealnej przyszłej pani domu w sarmackim świecie."]
        },
        {
            "type": "closed",
            "question": "W 'Zemście' Cześnik mówi do Papkina: 'Idź, serdeńko, bo cię trzepnę'. Ten zwrot jest przykładem komizmu językowego opartego na:",
            "answers": [
                { "text": "Użyciu wulgaryzmów.", "correct": false },
                { "text": "Zderzeniu pieszczotliwego, fałszywego zwrotu ('serdeńko') z brutalną groźbą ('bo cię trzepnę'), co tworzy absurdalny i komiczny efekt.", "correct": true },
                { "text": "Niezrozumieniu przez Papkina słów Cześnika.", "correct": false },
                { "text": "Użyciu archaicznego, niezrozumiałego słownictwa.", "correct": false }
            ]
        },
        {
            "type": "open",
            "question": "Wyjaśnij, dlaczego postać tytułowej 'Katarynki' z noweli Bolesława Prusa jest symbolem, a nie tylko instrumentem.",
            "answer": ["Katarynka jest symbolem prostej, ludowej sztuki i radości, która jest w stanie przełamać barierę społeczną i estetyczną. Dla pana Tomasza, estety, jest ona początkowo symbolem kiczu, ale z miłości do niewidomej dziewczynki staje się dla niego narzędziem empatii i symbolem przemiany – otwarcia się na świat i potrzeby 'maluczkich'."]
        },
        {
            "type": "closed",
            "question": "W 'Balladynie' postać Filona, pasterza-romantyka, pełni funkcję:",
            "answers": [
                { "text": "Głównego antagonisty, który rywalizuje z Kirkorem o władzę.", "correct": false },
                { "text": "Komicznego przerywnika, rozładowującego napięcie dramatu.", "correct": false },
                { "text": "Kontrapunktu dla brutalnego realizmu zbrodni; jest on uosobieniem sentymentalnej, wyidealizowanej miłości, która szuka idealnej kochanki, co kontrastuje z pragmatyczną i zbrodniczą postawą Balladyny.", "correct": true },
                { "text": "Detektywa, który próbuje rozwiązać zagadkę śmierci Aliny.", "correct": false }
            ]
        },
        {
            "type": "open",
            "question": "Zinterpretuj symbolikę przypowieści o miłosiernym Samarytaninie w kontekście pytania 'Kto jest moim bliźnim?'.",
            "answer": ["Przypowieść ta redefiniuje pojęcie 'bliźniego'. Bliźnim nie jest ten, kto należy do tej samej grupy etnicznej czy religijnej (jak kapłan i lewita), ale każdy, kto potrzebuje pomocy, oraz ten, kto tej pomocy udziela. Samarytanin, pogardzany przez Żydów, okazuje się prawdziwym 'bliźnim', co pokazuje, że miłosierdzie i człowieczeństwo stoją ponad podziałami społecznymi."]
        },
        {
            "type": "closed",
            "question": "Wskaż zdanie, w którym występuje błąd polegający na niewłaściwym użyciu przyimka.",
            "answers": [
                { "text": "Idę do szkoły na ósmą.", "correct": false },
                { "text": "Spotkajmy się za pięć minut.", "correct": false },
                { "text": "Wziąłem tabletkę na ból głowy.", "correct": false },
                { "text": "On mieszka na ulicy Kwiatowej.", "correct": true }
            ]
        },
        {
            "type": "open",
            "question": "Wyjaśnij, na czym polega tragizm losu postaci tytułowej z bajki 'O rybaku i rybce' Aleksandra Puszkina.",
            "answer": ["Jej tragizm polega na niepohamowanej chciwości i pysze, która prowadzi ją od biedy do absolutnej władzy, a następnie z powrotem do punktu wyjścia. Jest postacią, która nie potrafi docenić tego, co ma, i zawsze pragnie więcej. Jej upadek jest karą za moralną ślepotę i brak umiaru. To tragizm wiecznego niezaspokojenia."]
        },
        {
            "type": "closed",
            "question": "Wskaż, która z postaci literackich w najpełniejszy sposób uosabia romantyczny typ bohatera-tyrana, opętanego żądzą władzy.",
            "answers": [
                { "text": "Neron z 'Quo vadis'", "correct": false },
                { "text": "Balladyna z 'Balladyny'", "correct": true },
                { "text": "Rejent Milczek z 'Zemsty'", "correct": false },
                { "text": "Kirkor z 'Balladyny'", "correct": false }
            ]
        },
        {
            "type": "open",
            "question": "W 'Panu Tadeuszu' często opisywane są posiłki i uczty. Jaka jest funkcja tych opisów?",
            "answer": ["Opisy te pełnią funkcję obyczajową i kulturową. Pokazują bogactwo i specyfikę kuchni staropolskiej, a także hierarchię społeczną i zasady 'grzeczności' panujące przy stole. Uczta jest ważnym elementem życia wspólnoty, miejscem spotkań, rozmów i celebracji. Buduje to arkadyjski, uporządkowany obraz świata Soplicowa."]
        },
        {
            "type": "closed",
            "question": "W 'Opowieści wigilijnej', Duch Przyszłych Świąt jest jedynym duchem, który budzi w Scrooge'u prawdziwy strach. Dlaczego?",
            "answers": [
                { "text": "Ponieważ jest milczący, bezosobowy i nieubłagany, symbolizując ostateczność i nieodwracalność konsekwencji jego dotychczasowego życia.", "correct": true },
                { "text": "Ponieważ grozi mu fizyczną karą, jeśli się nie zmieni.", "correct": false },
                { "text": "Ponieważ pokazuje mu wizję piekła i wiecznego potępienia.", "correct": false },
                { "text": "Ponieważ jest najbrzydszy i najbardziej przerażający z wyglądu.", "correct": false }
            ]
        },
        {
            "type": "open",
            "question": "Przekształć zdanie w mowie zależnej na mowę niezależną: 'Kazała mi, żebym posprzątał swój pokój.'",
            "answer": ["Kazała mi: 'Posprzątaj swój pokój!'."]
        },
        {
            "type": "closed",
            "question": "Które z poniższych dzieł najpełniej realizuje model przypowieści (paraboli)?",
            "answers": [
                { "text": "'Zemsta'", "correct": false },
                { "text": "'Mały Książę'", "correct": true },
                { "text": "'Pan Tadeusz'", "correct": false },
                { "text": "'Chłopcy z Placu Broni'", "correct": false }
            ]
        },
        {
            "type": "open",
            "question": "Zinterpretuj symboliczną funkcję postaci Chilona Chilonidesa w 'Quo vadis'.",
            "answer": ["Chilon symbolizuje ludzką słabość, cynizm i zdolność do zdrady dla zysku. Jest on uosobieniem intelektualisty na usługach zła. Jednak jego postać jest także dowodem na możliwość głębokiej przemiany – w obliczu męczeństwa chrześcijan i własnego cierpienia doznaje wstrząsu moralnego i nawraca się, co pokazuje, że nawet w najbardziej zdeprawowanym człowieku tkwi iskra dobra."]
        },
        {
            "type": "closed",
            "question": "Wskaż zdanie, w którym występuje błąd w użyciu zaimka.",
            "answers": [
                { "text": "Dałem mu książkę, którą polecałeś.", "correct": false },
                { "text": "Poszedłem do niego, aby porozmawiać.", "correct": false },
                { "text": "Usiadłem na krześle, którego noga była złamana.", "correct": false },
                { "text": "Wziąłem parasol, bo jego prognoza zapowiadała deszcz.", "correct": true }
            ]
        },
        {
            "type": "open",
            "question": "Jaka jest symboliczna funkcja postaci Telimeny w kontekście polskiego społeczeństwa epoki porozbiorowej?",
            "answer": ["Telimena symbolizuje tę część polskiego społeczeństwa, która uległa fascynacji kulturą obcą (rosyjską, francuską), traktując ją jako wyznacznik nowoczesności i lepszego świata. Reprezentuje kosmopolityzm i odwrócenie się od rodzimej tradycji, co było jednym z dylematów tożsamościowych Polaków w tamtym okresie."]
        },
        {
            "type": "closed",
            "question": "Wskaż, która z postaci literackich w swoim postępowaniu kieruje się przede wszystkim wiernością i lojalnością wobec przywódcy/pana.",
            "answers": [
                { "text": "Papkin", "correct": false },
                { "text": "Gerwazy", "correct": true },
                { "text": "Wacław", "correct": false },
                { "text": "Hrabia", "correct": false }
            ]
        },
        {
            "type": "open",
            "question": "Wyjaśnij, na czym polega komizm sytuacyjny w 'Zemście'. Podaj jeden przykład.",
            "answer": ["Komizm sytuacyjny polega na tworzeniu zabawnych, nieoczekiwanych i absurdalnych zbiegów okoliczności i wydarzeń. Przykładem jest scena, w której Wacław, syn Rejenta, dobrowolnie oddaje się w 'niewolę' Cześnikowi, swojemu wrogowi, aby być bliżej ukochanej Klary, co Cześnik interpretuje jako akt tchórzostwa i kapitulacji."]
        },
        {
            "type": "closed",
            "question": "Co jest wspólnym elementem losu Ikara i Balladyny?",
            "answers": [
                { "text": "Dążenie do władzy, które prowadzi do upadku.", "correct": false },
                { "text": "Upadek (dosłowny i moralny) spowodowany przekroczeniem pewnych granic – Ikar przekracza granice wyznaczone przez naturę i ojca, a Balladyna granice moralne i ludzkie.", "correct": true },
                { "text": "Miłość, która staje się przyczyną ich zguby.", "correct": false },
                { "text": "Kara wymierzona przez bogów za nieposłuszeństwo.", "correct": false }
            ]
        },
        {
            "type": "open",
            "question": "Wskaż błąd frazeologiczny w zdaniu: 'On zawsze ubiera adidasy do garnituru' i wyjaśnij, na czym on polega.",
            "answer": ["Błąd polega na generalizacji nazwy własnej ('adidasy' od marki Adidas) i używaniu jej jako nazwy gatunkowej (buty sportowe). Chociaż jest to powszechne w języku potocznym, w normie wzorcowej jest to błąd. Poprawnie: 'On zawsze ubiera buty sportowe do garnituru'."]
        },
        {
            "type": "closed",
            "question": "Które z poniższych dzieł w najpełniejszy sposób ukazuje konflikt pokoleń na tle wielkich przemian historycznych?",
            "answers": [
                { "text": "'Zemsta'", "correct": false },
                { "text": "'Pan Tadeusz'", "correct": true },
                { "text": "'Latarnik'", "correct": false },
                { "text": "'Chłopcy z Placu Broni'", "correct": false }
            ]
        },
        {
            "type": "open",
            "question": "W 'Trenie XIX, czyli Śnie', matka mówi do Kochanowskiego: '[...] ludzkie przygody / Ludzkie noś'. Co oznaczają te słowa?",
            "answer": ["Oznaczają one wezwanie do przyjęcia stoickiej postawy wobec życia. 'Ludzkie przygody' to ludzki los, pełen cierpienia i radości. 'Ludzkie noś' to nakaz, by znosić ten los z godnością, umiarem i odwagą, akceptując, że cierpienie jest nieodłączną częścią bycia człowiekiem. To filozofia akceptacji ludzkiej doli."]
        }
    ]
// --- Pobranie elementów z HTML ---
const questionElement = document.getElementById("question");
const answerButtonsElement = document.getElementById("answer-buttons");
const openAnswerContainer = document.getElementById("open-answer-container");
const openAnswerInput = document.getElementById("open-answer-input");
const correctAnswerText = document.getElementById("correct-answer-text");
const actionButton = document.getElementById("action-btn");

const quizContainer = document.getElementById("quiz");
const resultsContainer = document.getElementById("results-container");
const scoreText = document.getElementById("score-text");
const restartButton = document.getElementById("restart-btn");

// --- Zmienne stanu quizu ---
let currentQuestionIndex = 0;
let score = 0;
let questionAnswered = false; // Flaga sprawdzająca, czy odpowiedź została już udzielona

// --- Funkcje Główne ---
function startQuiz() {
    currentQuestionIndex = 0;
    score = 0;
    questionAnswered = false;
    quizContainer.classList.remove("hidden");
    resultsContainer.classList.add("hidden");
    showQuestion();
}

function showQuestion() {
    resetState();
    const currentQuestion = questions[currentQuestionIndex];
    questionElement.innerHTML = `${currentQuestionIndex + 1}. ${currentQuestion.question}`;

    if (currentQuestion.type === 'closed') {
        answerButtonsElement.classList.remove("hidden");
        currentQuestion.answers.forEach(answer => {
            const button = document.createElement("button");
            button.innerHTML = answer.text;
            button.classList.add("btn");
            if (answer.correct) {
                button.dataset.correct = "true";
            }
            button.addEventListener("click", selectClosedAnswer);
            answerButtonsElement.appendChild(button);
        });
    } else if (currentQuestion.type === 'open') {
        openAnswerContainer.classList.remove("hidden");
        actionButton.innerHTML = "Sprawdź";
        actionButton.style.display = "block";
    }
}

function resetState() {
    questionAnswered = false;

    // Ukryj wszystko
    answerButtonsElement.classList.add("hidden");
    openAnswerContainer.classList.add("hidden");
    correctAnswerText.classList.add("hidden");
    actionButton.style.display = "none";

    // Wyczyść przyciski i pole input
    while (answerButtonsElement.firstChild) {
        answerButtonsElement.removeChild(answerButtonsElement.firstChild);
    }
    openAnswerInput.value = "";
    openAnswerInput.disabled = false;
    openAnswerInput.classList.remove("correct-input", "incorrect-input");
}

function selectClosedAnswer(e) {
    if (questionAnswered) return;
    questionAnswered = true;

    const selectedBtn = e.target;
    const isCorrect = selectedBtn.dataset.correct === "true";

    if (isCorrect) {
        selectedBtn.classList.add("correct");
        score++;
    } else {
        selectedBtn.classList.add("incorrect");
    }

    Array.from(answerButtonsElement.children).forEach(button => {
        if (button.dataset.correct === "true") {
            button.classList.add("correct");
        }
        button.disabled = true;
    });

    actionButton.innerHTML = "Następne";
    actionButton.style.display = "block";
}

function checkOpenAnswer() {
    if (questionAnswered) return;
    questionAnswered = true;

    const userAnswer = openAnswerInput.value.trim().toLowerCase();
    const correctAnswer = questions[currentQuestionIndex].answer;

    // Sprawdzamy, czy odpowiedź użytkownika znajduje się w tablicy poprawnych odpowiedzi
    if (correctAnswer.includes(userAnswer)) {
        openAnswerInput.classList.add("correct-input");
        score++;
    } else {
        openAnswerInput.classList.add("incorrect-input");
        correctAnswerText.innerHTML = `Poprawna odpowiedź: ${correctAnswer.join(" lub ")}`;
        correctAnswerText.classList.remove("hidden");
    }
    openAnswerInput.disabled = true;
    actionButton.innerHTML = "Następne";
}

function handleActionButton() {
    const currentQuestion = questions[currentQuestionIndex];

    // Jeśli pytanie jest otwarte i odpowiedź nie została sprawdzona
    if (currentQuestion.type === 'open' && !questionAnswered) {
        checkOpenAnswer();
    } else {
        // Przejdź do następnego pytania
        currentQuestionIndex++;
        if (currentQuestionIndex < questions.length) {
            showQuestion();
        } else {
            showResults();
        }
    }
}

function showResults() {
    quizContainer.classList.add("hidden");
    resultsContainer.classList.remove("hidden");
    scoreText.innerHTML = `Zdobyłeś ${score} z ${questions.length} punktów!`;
}

// --- Event Listeners ---
actionButton.addEventListener("click", handleActionButton);
restartButton.addEventListener("click", startQuiz);

// --- Rozpoczęcie quizu ---
startQuiz();